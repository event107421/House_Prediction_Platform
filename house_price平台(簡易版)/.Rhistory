house_type3 <- comment %>% html_nodes('.status4 span') %>% html_text() %>% iconv(from="UTF-8", to="UTF-8")
Title <- paste0(house_title[seq(1, 28, by = 3)], house_title[seq(2, 29, by = 3)])
Price <- paste0(house_price[seq(1, 19, by = 2)], house_price[seq(2, 20, by = 2)])
Type <- house_type1[seq(1,28,by = 3)]
House_age <- house_type1[seq(2,29,by = 3)]
Floor <- house_type1[seq(3,30,by = 3)]
Land_square_feet <- house_type2[seq(2,29,by = 3)]
Building_square_feet <- house_type2[seq(3,30,by = 3)]
House_pattern <- house_type2[seq(1,28,by = 3)]
Parking <- paste0(house_type3[seq(1, 19, by = 2)], house_type3[seq(2, 20, by = 2)])
p <- sub(",", "", Price)
p <- sub("萬", "", p)
p <- as.numeric(p)
m <- sub("坪", "", Building_square_feet)
m <- sub("建物", "", m)
m <- as.numeric(m)
unit_Price <- paste0(round(p/m,2), "萬")
house_data <- data.frame(Title, unit_Price = unit_Price, Price, Type, House_age, Floor, Land_square_feet, Building_square_feet, House_pattern, Parking, Web = house_web)
house_data_web <- datatable(house_data, escape = FALSE)
}
y <- get_nra_web(3, 242, 1)
get_nra_web <- function(town_number, area_number, pages){
street <- URLencode(street_spider)
#台北市city編號為1，新北市編號為3
#url <- paste0("http://www.nra.com.tw/buying/bsearch.php?page=",pages,"&search_ajax=1&search_type=&keyword=&mrts=&thsr=&school=&school_item=&town=",area_number,"&city=",town_number,"&house_use=&house_type=&area_size_s=0&area_size_l=999999&money_s=0&money_l=999999&parking=&s_room=&l_room=&sort_type=detail_day%20DESC")
url <- paste0("http://www.nra.com.tw/buying/bsearch.php?page=",pages,"&search_ajax=1&search_type=&keyword=",street,"&mrts=&thsr=&school=&school_item=&town=",area_number,"&city=",town_number,"&house_use=&house_type=&area_size_s=0&area_size_l=999999&money_s=0&money_l=999999&parking=&s_room=&l_room=&sort_type=detail_day%20DESC")
comment <- read_html(url)
web <- comment %>% html_nodes('.col-sm-8 a') %>% html_attr("href") %>% iconv(from="UTF-8", to="UTF-8")
web <- web[-c(1:28)]
web <- paste0('http://www.nra.com.tw/buying/',web)
house_web <- paste0('<a href="',web,'">',web,'</a>')
house_title <- comment %>% html_nodes('.limited_text') %>% html_text() %>% iconv(from="UTF-8", to="UTF-8")
house_price <- comment %>% html_nodes('.price_n span') %>% html_text() %>% iconv(from="UTF-8", to="UTF-8")
house_type1 <- comment %>% html_nodes('.status2 span') %>% html_text() %>% iconv(from="UTF-8", to="UTF-8")
house_type2 <- comment %>% html_nodes('.status3 span') %>% html_text() %>% iconv(from="UTF-8", to="UTF-8")
house_type3 <- comment %>% html_nodes('.status4 span') %>% html_text() %>% iconv(from="UTF-8", to="UTF-8")
Title <- paste0(house_title[seq(1, 28, by = 3)], house_title[seq(2, 29, by = 3)])
Price <- paste0(house_price[seq(1, 19, by = 2)], house_price[seq(2, 20, by = 2)])
Type <- house_type1[seq(1,28,by = 3)]
House_age <- house_type1[seq(2,29,by = 3)]
Floor <- house_type1[seq(3,30,by = 3)]
Land_square_feet <- house_type2[seq(2,29,by = 3)]
Building_square_feet <- house_type2[seq(3,30,by = 3)]
House_pattern <- house_type2[seq(1,28,by = 3)]
Parking <- paste0(house_type3[seq(1, 19, by = 2)], house_type3[seq(2, 20, by = 2)])
p <- sub(",", "", Price)
p <- sub("萬", "", p)
p <- as.numeric(p)
m <- sub("坪", "", Building_square_feet)
m <- sub("建物", "", m)
m <- as.numeric(m)
unit_Price <- paste0(round(p/m,2), "萬")
house_data <- data.frame(Title, unit_Price = unit_Price, Price, Type, House_age, Floor, Land_square_feet, Building_square_feet, House_pattern, Parking, Web = house_web)
house_data_web <- datatable(house_data, escape = FALSE)
}
t <- get_nra_web(3,242,"中正路",1)
get_nra_web <- function(town_number, area_number, street_spider, pages){
street <- URLencode(street_spider)
#台北市city編號為1，新北市編號為3
#url <- paste0("http://www.nra.com.tw/buying/bsearch.php?page=",pages,"&search_ajax=1&search_type=&keyword=&mrts=&thsr=&school=&school_item=&town=",area_number,"&city=",town_number,"&house_use=&house_type=&area_size_s=0&area_size_l=999999&money_s=0&money_l=999999&parking=&s_room=&l_room=&sort_type=detail_day%20DESC")
url <- paste0("http://www.nra.com.tw/buying/bsearch.php?page=",pages,"&search_ajax=1&search_type=&keyword=",street,"&mrts=&thsr=&school=&school_item=&town=",area_number,"&city=",town_number,"&house_use=&house_type=&area_size_s=0&area_size_l=999999&money_s=0&money_l=999999&parking=&s_room=&l_room=&sort_type=detail_day%20DESC")
comment <- read_html(url)
web <- comment %>% html_nodes('.col-sm-8 a') %>% html_attr("href") %>% iconv(from="UTF-8", to="UTF-8")
web <- web[-c(1:28)]
web <- paste0('http://www.nra.com.tw/buying/',web)
house_web <- paste0('<a href="',web,'">',web,'</a>')
house_title <- comment %>% html_nodes('.limited_text') %>% html_text() %>% iconv(from="UTF-8", to="UTF-8")
house_price <- comment %>% html_nodes('.price_n span') %>% html_text() %>% iconv(from="UTF-8", to="UTF-8")
house_type1 <- comment %>% html_nodes('.status2 span') %>% html_text() %>% iconv(from="UTF-8", to="UTF-8")
house_type2 <- comment %>% html_nodes('.status3 span') %>% html_text() %>% iconv(from="UTF-8", to="UTF-8")
house_type3 <- comment %>% html_nodes('.status4 span') %>% html_text() %>% iconv(from="UTF-8", to="UTF-8")
Title <- paste0(house_title[seq(1, 28, by = 3)], house_title[seq(2, 29, by = 3)])
Price <- paste0(house_price[seq(1, 19, by = 2)], house_price[seq(2, 20, by = 2)])
Type <- house_type1[seq(1,28,by = 3)]
House_age <- house_type1[seq(2,29,by = 3)]
Floor <- house_type1[seq(3,30,by = 3)]
Land_square_feet <- house_type2[seq(2,29,by = 3)]
Building_square_feet <- house_type2[seq(3,30,by = 3)]
House_pattern <- house_type2[seq(1,28,by = 3)]
Parking <- paste0(house_type3[seq(1, 19, by = 2)], house_type3[seq(2, 20, by = 2)])
p <- sub(",", "", Price)
p <- sub("萬", "", p)
p <- as.numeric(p)
m <- sub("坪", "", Building_square_feet)
m <- sub("建物", "", m)
m <- as.numeric(m)
unit_Price <- paste0(round(p/m,2), "萬")
house_data <- data.frame(Title, unit_Price = unit_Price, Price, Type, House_age, Floor, Land_square_feet, Building_square_feet, House_pattern, Parking, Web = house_web)
house_data_web <- datatable(house_data, escape = FALSE)
}
t <- get_nra_web(3,242,"中正路",1)
street_spider <- "中正路"
t <- get_nra_web(3,242,street_spider,1)
shiny::runApp()
shiny::runApp()
runApp()
x <- get_yungching_web("台北市", "士林區", "中正路", 1)
town_spider <- "台北市"
area_spider <- "士林區"
street_spider<- "中正路"
page <- 1
x_a <- URLencode(town_spider)
x_b <- URLencode(area_spider)
x <- paste0(x_a,'-',x_b)
street <- URLencode(street_spider)
url <- paste0('http://buy.yungching.com.tw/region/%E4%BD%8F%E5%AE%85_p/',x,'_c/?kw=',street,'&od=80&pg=',page)
comment <- read_html(url)
web <- comment %>% html_nodes('.item-info a') %>% html_attr("href") %>% iconv(from="UTF-8", to="UTF-8")
comment <- read_html(url)
web <- comment %>% html_nodes('.item-info a') %>% html_attr("href") %>% iconv(from="UTF-8", to="UTF-8")
house_web <- paste0('http://buy.yungching.com.tw',web)
url <- paste0('https://buy.yungching.com.tw/region/%E4%BD%8F%E5%AE%85_p/',x,'_c/?kw=',street,'&od=80&pg=',page)
comment <- read_html(url)
web <- comment %>% html_nodes('.item-info a') %>% html_attr("href") %>% iconv(from="UTF-8", to="UTF-8")
uastring <- "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36"
url <- paste0('https://buy.yungching.com.tw/region/%E4%BD%8F%E5%AE%85_p/',x,'_c/?kw=',street,'&od=80&pg=',page)
session <- html_session(url, user_agent(uastring))
library(rvest)
library(httr)
uastring <- "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36"
url <- paste0('https://buy.yungching.com.tw/region/%E4%BD%8F%E5%AE%85_p/',x,'_c/?kw=',street,'&od=80&pg=',page)
session <- html_session(url, user_agent(uastring))
web <- session %>% html_nodes('.item-info a') %>% html_attr("href") %>% iconv(from="UTF-8", to="UTF-8")
https://buy.yungching.com.tw/region/%E5%8F%B0%E5%8C%97%E5%B8%82-%E5%A3%AB%E6%9E%97%E5%8D%80_c/
url
load("I:/論文/建模/ANN/新北數量_虛擬.RData")
library(nnet)
library(caret)
model2
model1
shiny::runApp()
get_yungching_web <- function(town_spider, area_spider, street_spider, page) {
# x_a <- as.character(charToRaw(town_spider))
# temp <- ""
# for (i in 1:length(x_a)) {
#   temp <- paste0(temp,'%',x_a[i])
# }
# x_a <- as.character(temp)
#
# x_b <- as.character(charToRaw(area_spider))
# temp2 <- ""
# for (i in 1:length(x_b)) {
#   temp2 <- paste0(temp2,'%',x_b[i])
# }
# x_b <- as.character(temp2)
x_a <- URLencode(town_spider)
x_b <- URLencode(area_spider)
x <- paste0(x_a,'-',x_b)
street <- URLencode(street_spider)
url <- paste0('http://buy.yungching.com.tw/region/%E4%BD%8F%E5%AE%85_p/',x,'_c/?kw=',street,'&od=80&pg=',page)
comment <- read_html(url)
web <- comment %>% html_nodes('.item-info a') %>% html_attr("href") %>% iconv(from="UTF-8", to="UTF-8")
house_web <- paste0('http://buy.yungching.com.tw',web)
house_web_new <- paste0('<a href="',house_web,'">',house_web,'</a>')
house_title <- comment %>% html_nodes('.item-info a') %>% html_attr("title") %>% iconv(from="UTF-8", to="UTF-8")
house_price <- comment %>% html_nodes('.price') %>% html_text() %>% iconv(from="UTF-8", to="UTF-8")
house_type <- comment %>% html_nodes('.item-info ul') %>% html_text() %>% iconv(from="UTF-8", to="UTF-8")
type <- strsplit(house_type,"\r\n")
house_data <- data.frame(t(data.frame(type)), row.names = c(1:length(house_title)))
house_data <- house_data[,c(-2,-4,-9,-11,-13,-15)]
colnames(house_data) <- c("Type", "House_age", "Floor", "Land_square_feet",
"Square_feet_type", "Building_square_feet",
"House_pattern", "Add", "Parking")
p <- sub(" ", "", house_price)
p <- sub(",", "", p)
p <- sub("萬", "", p)
p <- as.numeric(p)
m <- sub(" ", "", house_data$Building_square_feet)
m <- sub("坪", "", m)
m <- sub("建物", "", m)
m <- as.numeric(m)
unit_Price <- paste0(round(p/m,2), "萬")
house_data_new <- data.frame(Name = house_title, unit_Price = unit_Price, Price = house_price, house_data, Web = house_web_new)
house_data_web <- datatable(house_data_new, escape = FALSE)
return(house_data_web)
}
x <- get_yungching_web("台北市", "士林區", "中正路", 1)
town_spider <- "台北市"
area_spider <- "士林區"
street_spider<- "中正路"
page <- 1
x_a <- URLencode(town_spider)
x_b <- URLencode(area_spider)
x <- paste0(x_a,'-',x_b)
street <- URLencode(street_spider)
url <- paste0('http://buy.yungching.com.tw/region/%E4%BD%8F%E5%AE%85_p/',x,'_c/?kw=',street,'&od=80&pg=',page)
comment <- read_html(url)
url <- paste0('https://buy.yungching.com.tw/region/%E4%BD%8F%E5%AE%85_p/',x,'_c/?kw=',street,'&od=80&pg=',page)  comment <- read_html(url)
url <- paste0('https://buy.yungching.com.tw/region/%E4%BD%8F%E5%AE%85_p/',x,'_c/?kw=',street,'&od=80&pg=',page)
comment <- read_html(url)
library("rvest", lib.loc="~/R/win-library/3.4")
url <- paste0('https://buy.yungching.com.tw/region/%E4%BD%8F%E5%AE%85_p/',x,'_c/?kw=',street,'&od=80&pg=',page)
comment <- read_html(url)
remove.packages("rvest", lib="~/R/win-library/3.4")
install.packages("rvest")
library("rvest", lib.loc="~/R/win-library/3.4")
url <- paste0('https://buy.yungching.com.tw/region/%E4%BD%8F%E5%AE%85_p/',x,'_c/?kw=',street,'&od=80&pg=',page)
comment <- read_html(url)
shiny::runApp()
runApp()
x_a <- URLencode(town_spider)
x_b <- URLencode(area_spider)
x <- paste0(x_a,'-',x_b)
street <- URLencode(street_spider)
url <- paste0('http://buy.yungching.com.tw/region/%E4%BD%8F%E5%AE%85_p/',x,'_c/?kw=',street,'&od=80&pg=',page)
comment <- read_html(url)
url <- "https://buy.yungching.com.tw/region/%E4%BD%8F%E5%AE%85_p/%E5%8F%B0%E5%8C%97%E5%B8%82-%E5%A3%AB%E6%9E%97%E5%8D%80_c/?kw=%E4%B8%AD%E6%AD%A3%E8%B7%AF"
comment <- read_html(url)
web <- comment %>% html_nodes('.item-info a') %>% html_attr("href") %>% iconv(from="UTF-8", to="UTF-8")
town_spider <- iconv(town_spider, from='big5', to='UTF-8')
x_a <- URLencode(town_spider)
runApp()
runApp()
runApp()
street_spider <- "博愛路"
town_spider <- "台北市"
area_spider <- "中正區"
town_spider <- iconv(town_spider, from='big5', to='UTF-8')
x_a <- URLencode(town_spider)
area_spider <- iconv(area_spider, from='big5', to='UTF-8')
x_b <- URLencode(area_spider)
x <- paste0(x_a,'-',x_b)
street_spider <- iconv(street_spider, from='big5', to='UTF-8')
street <- URLencode(street_spider)
page <- 1
url <- paste0('http://buy.yungching.com.tw/region/%E4%BD%8F%E5%AE%85_p/',x,'_c/?kw=',street,'&od=80&pg=',page)
comment <- read_html(url)
web <- comment %>% html_nodes('.item-info a') %>% html_attr("href") %>% iconv(from="UTF-8", to="UTF-8")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp('C:/Users/stat/Desktop/R地圖/平台')
runApp('C:/Users/stat/Desktop/R地圖/平台')
town_spider <- "台北市"
area_spider <- "士林區"
street_spider <- "中正路"
page <- 1
town_spider <- iconv(town_spider, from='UTF-8', to='UTF-8')
x_a <- URLencode(town_spider)
town_spider <- iconv(town_spider, from='big5', to='UTF-8')
x_a <- URLencode(town_spider)
town_spider <- "台北市"
town_spider <- iconv(town_spider, from='big5', to='UTF-8')
x_a <- URLencode(town_spider)
area_spider <- iconv(area_spider, from='big5', to='UTF-8')
x_b <- URLencode(area_spider)
x <- paste0(x_a,'-',x_b)
street_spider <- iconv(street_spider, from='big5', to='UTF-8')
street <- URLencode(street_spider)
url <- paste0('http://buy.yungching.com.tw/region/%E4%BD%8F%E5%AE%85_p/',x,'_c/?kw=',street,'&od=80&pg=',page)
comment <- read_html(url)
web <- comment %>% html_nodes('.item-info a') %>% html_attr("href") %>% iconv(from="UTF-8", to="UTF-8")
uastring <- "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36"
url <- paste0('https://buy.yungching.com.tw/region/%E4%BD%8F%E5%AE%85_p/',x,'_c/?kw=',street,'&od=80&pg=',page)
session <- html_session(url, user_agent(uastring))
web <- session %>% html_nodes('.item-info a') %>% html_attr("href") %>% iconv(from="UTF-8", to="UTF-8")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
load("I:/論文/平台/model/rf_house_model.RData")
shiny::runApp()
load("I:/論文/平台/model/rf_house_model.RData")
runApp('C:/Users/stat/Desktop')
runApp('C:/Users/stat/Desktop')
runApp('C:/Users/stat/Desktop')
runApp('C:/Users/stat/Desktop')
runApp('C:/Users/stat/Desktop')
runApp('C:/Users/stat/Desktop')
library(shiny); runApp('apps.R')
runApp('apps.R')
runApp('apps.R')
runApp('apps.R')
library(ggplot2)
rm(list = ls())
# First rocket
t1 = 1:30            # number of points
size1 = 2            # size of rocket
r1_center = c(-4,10) # end center
rocket1 = data.frame(x1 = rep(r1_center[1], length(t1))
, x2 = size1*cos(t1)  + r1_center[1]
, y1 = rep(r1_center[2], length(t1))
, y2 = size1*sin(t1) + r1_center[2]
)
# Second rocket
t2 = 1:44
size2 = 3
r2_center = c(3,12)
rocket2 = data.frame(x1 = rep(r2_center[1], length(t2))
, x2 = size2*cos(t2)  + r2_center[1]
, y1 = rep(r2_center[2], length(t2))
, y2 = size2*sin(t2) + r2_center[2]
)
# Third rocket
t3 = 1:44
size3 = 4
r3_center = c(-2,17)
rocket3 = data.frame(x1 = rep(r3_center[1], length(t3))
, x2 = size3*cos(t3)  + r3_center[1]
, y1 = rep(r3_center[2], length(t3))
, y2 = size3*sin(t3) + r3_center[2]
)
# Fourth rocket
t4 = 1:44
size4 = 4
r4_center = c(4,20)
rocket4 = data.frame(x1 = rep(r4_center[1], length(t4))
, x2 = size4*cos(t4)  + r4_center[1]
, y1 = rep(r4_center[2], length(t4))
, y2 = size4*sin(t4) + r4_center[2]
)
# Plot fireworks
ggplot() +
# set theme
theme(panel.background = element_rect(fill = '#252525', colour = '#252525'),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.line=element_blank(),axis.text.x=element_blank(),
axis.text.y=element_blank(),axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),legend.position="none") +
# first rocket
geom_point(aes(x = x2, y = y2), data = rocket1, shape = 4, colour = '#74add1')+
geom_curve(aes(x = x1, y = y1, xend = x2, yend = y2 ), curvature = 0.1, data = rocket1, colour = '#74add1') +
geom_curve(aes(x = 0, y = -7, xend = r1_center[1], yend = r1_center[2] ), curvature = 0.1, colour = '#878787') +
# second rocket
geom_point(aes(x = x2, y = y2), data = rocket2, shape = 4, colour = '#fed976')+
geom_curve(aes(x = x1, y = y1, xend = x2, yend = y2), curvature = 0.1, data = rocket2, colour = '#fed976') +
geom_curve(aes(x = 0, y = -7, xend = r2_center[1], yend = r2_center[2] ), curvature = -0.1, colour = '#878787') +
# third rocket
geom_point(aes(x = x2, y = y2), data = rocket3, shape = 4, colour = '#fa9fb5')+
geom_curve(aes(x = x1, y = y1, xend = x2, yend = y2 ), curvature = 0.1, data = rocket3, colour = '#fa9fb5') +
geom_curve(aes(x = 0, y = -7, xend = r3_center[1], yend = r3_center[2] ), curvature = 0.1, colour = '#878787') +
# fouth rocket
geom_point(aes(x = x2, y = y2), data = rocket4, shape = 4, colour = '#addd8e')+
geom_curve(aes(x = x1, y = y1, xend = x2, yend = y2 ), curvature = 0.1, data = rocket4, colour = '#addd8e') +
geom_curve(aes(x = 0, y = -7, xend = r4_center[1], yend = r4_center[2] ), curvature = -0.2, colour = '#878787') +
# title
ggtitle('The Analytics Lab wishes you a Happy New Year') +
# save
ggsave('Happy New Year.png', units = 'cm', width = 15, height = 20)
#靜態
library("scatterplot3d")
z <- seq(-10, 10, 0.01)
x <- cos(z)
y <- sin(z)
scatterplot3d(x, y, z, highlight.3d=TRUE, col.axis="blue", col.grid="lightblue",main="scatterplot3d - 1", pch=20)
#動態
library(rgl)
plot3d(x, y, z,col="red", size=5)
tags()#R結合HTML的函數，總共有110種HTML的函數
tags$h1("My header")#h1為創造HTML的標題函數
library(shiny)
tags()#R結合HTML的函數，總共有110種HTML的函數
shiny::tags()#R結合HTML的函數，總共有110種HTML的函數
shiny::tags#R結合HTML的函數，總共有110種HTML的函數
tags$h1("My header")#h1為創造HTML的標題函數
# R結合HTML的函數，總共有110種HTML的函數
names(tags)
shinyApp(
ui = list(
div(
class = "divclass",
h1("這是主標題"),
h2("這是副標題"),
p("這是內容段落"),
tags$li("列表項目1"),
tags$li("列表項目2"),
tags$script(src="幻燈片播放.js"),
),
hr(),
tags$head(
tags$title("頁面標題"),
tags$style(
rel="stylesheet",
"h1 {color: red; text-aligh: center;}",
".divclass {width: 600px; float: center; margin: 0 auto;}"
)
)
),
server = function(input, output, session) {}
)
runApp('~/Downloads/R學習/程式碼/plotly接leaflet.R')
#靜態
library("scatterplot3d")
z <- seq(-10, 10, 0.01)
x <- cos(z)
y <- sin(z)
scatterplot3d(x, y, z, highlight.3d=TRUE, col.axis="blue", col.grid="lightblue",main="scatterplot3d - 1", pch=20)
#動態
library(rgl)
plot3d(x, y, z,col="red", size=5)
library(plotly)
library(rjson)
# Create Canvas
p <- plot_ly(
type = "sankey",
domain = list(
x =  c(0,1),
y =  c(0,1)
),
orientation = "h",
valueformat = ".0f",
valuesuffix = "TWh"
) %>%
layout(
title = "Energy forecast for 2050, UK - Department of Energy & Climate Change",
font = list(
size = 10
),
xaxis = list(showgrid = F, zeroline = F),
yaxis = list(showgrid = F, zeroline = F)
)
# Add Nodes
json_file <- "https://raw.githubusercontent.com/plotly/plotly.js/master/test/image/mocks/sankey_energy.json"
json_data <- fromJSON(paste(readLines(json_file), collapse=""))
p <- plot_ly(
type = "sankey",
domain = list(
x =  c(0,1),
y =  c(0,1)
),
orientation = "h",
valueformat = ".0f",
valuesuffix = "TWh",
node = list(
label = json_data$data[[1]]$node$label,
color = json_data$data[[1]]$node$color,
pad = 15,
thickness = 15,
line = list(
color = "black",
width = 0.5
)
)
) %>%
layout(
title = "Energy forecast for 2050, UK - Department of Energy & Climate Change",
font = list(
size = 10
),
xaxis = list(showgrid = F, zeroline = F),
yaxis = list(showgrid = F, zeroline = F)
)
json_file <- "https://raw.githubusercontent.com/plotly/plotly.js/master/test/image/mocks/sankey_energy.json"
json_data <- fromJSON(paste(readLines(json_file), collapse=""))
p <- plot_ly(
type = "sankey",
domain = list(
x =  c(0,1),
y =  c(0,1)
),
orientation = "h",
valueformat = ".0f",
valuesuffix = "TWh",
node = list(
label = json_data$data[[1]]$node$label,
color = json_data$data[[1]]$node$color,
pad = 15,
thickness = 15,
line = list(
color = "black",
width = 0.5
)
),
link = list(
source = json_data$data[[1]]$link$source,
target = json_data$data[[1]]$link$target,
value =  json_data$data[[1]]$link$value,
label =  json_data$data[[1]]$link$label
)
) %>%
layout(
title = "Energy forecast for 2050<br>Source: Department of Energy & Climate Change, Tom Counsell via <a href='https://bost.ocks.org/mike/sankey/'>Mike Bostock</a>",
font = list(
size = 10
),
xaxis = list(showgrid = F, zeroline = F),
yaxis = list(showgrid = F, zeroline = F)
)
p
data <- t(USPersonalExpenditure)
data <- data.frame("year"=rownames(data), data)
p <- plot_ly(data, x = ~year, y = ~Food.and.Tobacco, name = 'Food and Tobacco', type = 'scatter', mode = 'none', fill = 'tozeroy', fillcolor = '#F5FF8D') %>%
add_trace(y = ~Household.Operation, name = 'Household Operation', fillcolor = '#50CB86') %>%
add_trace(y = ~Medical.and.Health, name = 'Medical and Health', fillcolor = '#4C74C9') %>%
add_trace(y = ~Personal.Care, name = 'Personal Care', fillcolor = '#700961') %>%
add_trace(y = ~Private.Education, name = 'Private Education', fillcolor = '#312F44') %>%
layout(title = 'United States Personal Expenditures by Categories',
xaxis = list(title = "",
showgrid = FALSE),
yaxis = list(title = "Expenditures (in billions of dollars)",
showgrid = FALSE))
p
